# 第16章 国际化

虽然我们实际开发过程中对国际化考虑地比较少，但是 HTTP 作为万维网的核心，它需要传输和处理各种语言和字母表编写的国际性文档，以真正地实现 World Wide。

## 字符集

描述了一种把实体内容的二进制码转换为特定字母表中字符的算法（要注意这和它字面意义存在差异）。HTTP 应用会使用字符集编码请求和显示不同字母表中的文本。

举例：
`Content-Type: text/html; charset=iso-8859-6`代表服务端告知客户端用阿拉伯字符集的解码算法把内容中的二进制转换为字符。
`Accept-Charset: iso-8859-1, utf-8` 代表浏览器支持 iso-8859-1 西欧字符集编码和 utf-8 Unicode 字符集编码

所有字符集的值称为 **MIME 字符集**，也在 IANA 注册（[http://www.iana.org/numbers.html）。](http://www.iana.org/numbers.html%EF%BC%89%E3%80%82)

服务端使用 Content-Type 的 charset参数来传递 MIME 字符集。
而客户端使用 Accept-Charset 首部来描述支持什么字符系统。（这俩方式设计地不对称… 如果服务端使用Content-Charset 就好了）

如果服务端没有通过 charset 参数传递字符集的话，客户端可能可以从别的地方来推断字符集。比如 HTML 文档就有个描述 charset 的meta 标签
举例：`<meta http-equiv="Content-Type" content="text/html; charset=iso-2022-jp">`

如果客户端没有推断出字符集编码方式的话，就默认假设使用 `ios-8859-1`

## 字符系统（略，不开发国际化应用的话暂时可以不用了解）

## 语言标记

命名口语的标准化字符串短语。HTTP 应用使用语言标记来根据用户所理解的语言来说明或者限制内容

Content-Language：描述实体的目标受众语言，可以是多种语言。
Accept-Language：客户端描述支持的语言

举例：
`Content-Language: cn, en`代表文档是一份同时用中文和英语写的译稿
`Accept-Language: fr, en;q=0.8` 代表客户端请求使用法语或者英语，法语优先，英语的质量因子（优先级）为0.8

语言标记分为多个子标记。

- 第一个子标记是主子标记，值是标准化的，代表语言，也在 IANA 中注册。比如 en、cn、fr 等等，通常小写
- 第二个子标记可选，遵循自己的命名标准。通常是国家代号，比如 CN、US、FR 等等，通常大写。
- 之后的子标记都是未注册的。
举例：`en-GB`，代表英国英语。

## 国际化的 URI

其实，URI 并不够满足国际化要求，因为 URI 使用的是 US-ASCII 码的子集，但世界上很多人根本不认识拉丁字母。

URI 字符集合包括 保留字符、未保留字符 以及 转义字符三类。

- 未保留：[A-Za-z0-9]|-|_\.|!|~|*|'|(|)|
- 保留： ;|/|?|:|@|&|=| |$|,
- 转义：%<HEX><HEX>

转义的目的是提供一种安全方式在 URI 中插入保留字符或者不支持的字符（但需要位于 US-ASCII 码内，也就是 ASCII 码 0 ~ 127的内容），格式是 % + 两个表示十六进制数字的字符。比如空格对应着 ASCII 码32，32的十六进制是20，那么空格的转义字符就是 %20。